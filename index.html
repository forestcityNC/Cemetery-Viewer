<!DOCTYPE html>
<html>
<head>
  <meta charset=utf-8 />
  <title>Cool Springs Cemetery Viewer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />

<!--leaflet -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"></script>

<!-- CSS-->


<!-- JS -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
<script src="./js/leaflet.ajax.min.js"> </script>



</head>
<body>
<div id="map">
  <div id="sidebar">
    <h2 style="font-family:Archivo Black, sans-serif;">Cool Springs Cemetery</h2>
    <h3 style="font-family:Archivo Black, sans-serif;">Forest City, N.C.</h3>
    <h5 style="font-family:Archivo Black, sans-serif;">
    Address: 382 W Main St, Forest City, N.C. 28043<br>
    Phone: 570-319-1296<br>
    Fax 570-319-1321<br>
    Hours: 9:00 A.M. â€“ 3:00 P.M., Monday through Friday<br>
    E-mail Address: Secretary@Scotttownship.org</span></h5>
    <hr />
    <strong>Use zoom controls to navigate the map. Pinch & zoom and double tap to zoom have been disabled.</strong>
    <hr />
    <em>The parcels shown are for informational purposes only. <br>Map data is only updated once or so per year.</em>

    <div>
      <hr />
      <button id="showTools" type="button" class="btn btn-default btn-xs btn-block">Show Map Tools Legend</button>
      <button id="hideTools" type="button" class="btn btn-default btn-xs btn-block" style="display:none;">Hide Map Tools Legend</button>
      <div class="toolLegend" style="display:none;">
        <hr />
      <div class="list-group" style="text-align:left;">
      <div class="list-group" style="text-align:left;">
       <li class="list-group-item"><i class='fa fa-bars fa-fw fa-lg'></i> Open Sidebar</li>
       <li class="list-group-item"><i class='fa fa-exchange fa-fw fa-lg'></i> Toggle Address Search</li>
       <li class="list-group-item"><img src="images/fullscreen.png" style="padding:0 1px;width:22px;"></img> Fullscreen</li>
       <li class="list-group-item"><i class='fa fa-globe fa-fw fa-lg'></i> Default Map Extent</li>
       <li class="list-group-item"><i class='fa fa-map-marker fa-fw fa-lg'></i> Show/Follow Your Location</li>
       <li class="list-group-item"><i class='fa fa-cogs fa-fw fa-lg'></i> Toggle Map Tools (Mobile Only)</li>
       <li class="list-group-item"><img src="images/layers-bl.png" style="padding:0 1px;width:22px;"></img> Toggle Map Layers</li>
     </div>

        </div>
      </div>
      <hr />
    </div>
    <script>
      $("#showTools").click(function () {
        $(".toolLegend").toggle();
        $("#showTools").toggle();
        $("#hideTools").toggle();
      });
      $("#hideTools").click(function () {
        $(".toolLegend").toggle();
        $("#showTools").toggle();
        $("#hideTools").toggle();
      });
    </script>
  </div>

</div>

<script>
// var mapboxToken = 'pk.eyJ1IjoiZGJoYXJyaXM5MiIsImEiOiJjamo1dm5hOGswOHMzM2tubm12OGhjdXdzIn0.MXeiHXd9767rehYZ2fBVHQ';

// Add Basemaps //
var satellite = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', { attribution: 'Tiles &copy; Esri', maxZoom: 21});
var carto = L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>', subdomains: 'abcd', maxZoom:21});
var osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {maxZoom: 22, attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',});
// Load Map and Controller //
var map = L.map('map', {
			    layers: [satellite] // only add one!
		    })
		    .setView([35.339344, -81.871195], 18);

		var baseLayers = {
      "Satellite": satellite,
      "Plain Base": carto,
      "Open Street Map": osm

		};

  //  var overlay = {
	//	    "Cemetery Image": cemetery
	//	};

		L.control.layers(baseLayers).addTo(map);
    // Cemetery Image Overlay //
    var image = L.imageOverlay(
             'data/cemetery.png',
             [[35.3384289150000015, -81.8729286509999952], [35.3413388549999965, -81.8691185509999997]], {
             opacity: 1
         }).addTo(map);



    /*_includes/map-tiles.js*/
    /*Attribution Toggle and OSM Edit Link*/
    //remove existing attribution control by hiding it only on mobile
    //make sure the normal control is hidden


// Add Cemetery Plot Style //
var plotstyle = {
    "color": "#000000",
    "weight": 1,
    "opacity": 0.65
};


//end OVRDC Modern UI Toolbar

// Load Cemetery Data
var plots = L.geoJson.ajax("./data/cemetery_A.geojson", {
    style: plotstyle,
    onEachFeature: function (feature, layer) {
      layer.bindPopup(
        '<h3>' + 'A ' + feature.properties.LOT_NUM + '</h3>' +
        "<table>" +
        // ternary operator conditional statement to remove null values (how to remove null rows )
        "<tr>" + '<th>Owner: </th>'+ "<td>" + (feature.properties.OWNER_FULL ? feature.properties.OWNER_FULL : '') + "</td>" + "</tr>" +
        // trying to have some rows invisible if null, below does not yet achieve this
        (feature.properties.OWNER_B_FULL ? "<tr>" + '<th>Owner B: </th>' + "<td>" + feature.properties.OWNER_B_FULL : '') + "</td>" + "</tr>" +
        "<tr>" + '<th>Purchase Date: </th>'+ "<td>" + (feature.properties.PURCHSE_DATE ? feature.properties.PURCHSE_DATE : '') + "</td>" + "</tr>" +
        "<tr>" + '<th>Previous Owner: </th>'+ "<td>" + (feature.properties.PREVIOUS_OWNER ? feature.properties.PREVIOUS_OWNER : '') + "</td>" + "</tr>" +
        "</table>"
      )},
  }).addTo(map);

  //Feature search
  var search = new L.Control.Search({
    layer: plots,
    initial: true,
    propertyName: 'OWNER_LAST_NAME',
    circleLocation:false,
    collapsed:false,
    textPlaceholder:'Search By Plot Owner Last Name',
    zoom:'19'});
  search.on('search_locationfound', function() { map.setZoom(21); });
  search.on ('search_locationfound', function(e) {
      e.layer.fire('click');
      search.collapse();
    });
  map.addControl(search);
  //end feature search





</script>
</body>
