<!DOCTYPE html>
<html>
<head>
  <meta charset=utf-8 />
  <title>Cool Springs Cemetery Viewer</title>


<!-- CSS-->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css" integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA==" crossorigin=""/>
<link rel="stylesheet" href="./css/modern-ui.css" />


<!-- <script src="https://unpkg.com/geotiff@0.4.1/dist/main.js"></script>
<script src="js/leaflet-geotiff.js"></script> -->

<!-- JS -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
<script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js" integrity="sha512-QVftwZFqvtRNi0ZyCtsznlKSWOStnDORoefr1enyq5mVL4tmKB3S/EnC3rRJcxCPavG10IcrVGSmPh6Qw5lwrg==" crossorigin=""></script>
<script src="./js/leaflet-search.js"> </script>

</head>
<body>
<div id="map" style="width: 1000px; height:700px"></div>

<script>
// var mapboxToken = 'pk.eyJ1IjoiZGJoYXJyaXM5MiIsImEiOiJjamo1dm5hOGswOHMzM2tubm12OGhjdXdzIn0.MXeiHXd9767rehYZ2fBVHQ';

// Add Basemaps //
var satellite = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', { attribution: 'Tiles &copy; Esri', maxZoom: 21});
var carto = L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>', subdomains: 'abcd', maxZoom:21});

// Load Map and Controller //
var map = L.map('map', {
			    layers: [satellite] // only add one!
		    })
		    .setView([35.339344, -81.871195], 19);

		var baseLayers = {
      "Satellite": satellite,
      "Plain Base": carto

		};

  //  var overlay = {
	//	    "Cemetery Image": cemetery
	//	};

		L.control.layers(baseLayers).addTo(map);
    // Cemetery Image Overlay //
    var image = L.imageOverlay(
             'data/cemetery.png',
             [[35.3384289150000015, -81.8729286509999952], [35.3413388549999965, -81.8691185509999997]], {
             opacity: 1
         }).addTo(map);

// Add Cemetery Plots //
var plotstyle = {
    "color": "#000000",
    "weight": 1,
    "opacity": 0.65
};
//
$.getJSON("./data/cemetery_A.geojson",function(data){
  var plots_a = L.geoJson(data, {
    style: plotstyle,
    onEachFeature: function (feature, layer) {
      layer.bindPopup(
        '<h3>' + 'A ' + feature.properties.LOT_NUM + '</h3>' +
        "<table>" +
        // ternary operator conditional statement to remove null values (how to remove null rows )
        "<tr>" + '<th>Owner: </th>'+ "<td>" + (feature.properties.OWNER_FULL ? feature.properties.OWNER_FULL : '') + "</td>" + "</tr>" +
        // trying to have some rows invisible if null, below does not yet achieve this
        (feature.properties.OWNER_B_FULL ? "<tr>" + '<th>Owner B: </th>' + "<td>" + feature.properties.OWNER_B_FULL : '') + "</td>" + "</tr>" +
        "<tr>" + '<th>Purchase Date: </th>'+ "<td>" + (feature.properties.PURCHSE_DATE ? feature.properties.PURCHSE_DATE : '') + "</td>" + "</tr>" +
        "<tr>" + '<th>Previous Owner: </th>'+ "<td>" + (feature.properties.PREVIOUS_OWNER ? feature.properties.PREVIOUS_OWNER : '') + "</td>" + "</tr>" +
        "</table>"


      )},

  });
  plots_a.addTo(map);
});








</script>
</body>
